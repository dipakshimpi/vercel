<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice {{billNo}}</title>
    <style>
        @page { size: A4; margin: 0; }
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            margin: 0; 
            padding: 25px; 
            color: #000; 
            line-height: 1.2; 
        }
        
        .main-border { 
            border: 1.5px solid #000; 
            min-height: 1000px; 
            display: flex; 
            flex-direction: column; 
        }

        .company-header { padding: 10px; border-bottom: 1.5px solid #000; display: flex; justify-content: space-between; }
        .company-info { font-size: 10px; width: 65%; }
        .company-logo-area { text-align: right; width: 30%; }

        .info-grid { display: flex; border-bottom: 1px solid #000; }
        .info-col { flex: 1; padding: 5px 10px; border-right: 1px solid #000; font-size: 10px; }
        .info-col:last-child { border-right: none; }

        .address-header { display: flex; background-color: #e2e2e2; border-bottom: 1px solid #000; }
        .address-title { flex: 1; padding: 4px 10px; font-weight: bold; font-size: 11px; border-right: 1px solid #000; }
        .address-title:last-child { border-right: none; }

        .address-content { display: flex; border-bottom: 1px solid #000; min-height: 110px; }
        .address-box { flex: 1; padding: 8px 10px; font-size: 10px; border-right: 1px solid #000; }
        .address-box:last-child { border-right: none; }

        table { width: 100%; border-collapse: collapse; }
        th { background-color: #e2e2e2; border: 1px solid #000; padding: 6px; font-size: 11px; text-align: left; }
        td { border-left: 1px solid #000; border-right: 1px solid #000; padding: 8px 10px; font-size: 10.5px; vertical-align: top; }
        .item-row { height: 380px; } /* Ensures the table takes up vertical space */

        .footer-grid { display: flex; border-top: 1.5px solid #000; flex-grow: 1; }
        .footer-left { flex: 1.6; border-right: 1px solid #000; padding: 10px; font-size: 10px; }
        
        .footer-right { flex: 1; display: flex; flex-direction: column; }
        .calc-row { display: flex; border-bottom: 1px solid #000; font-size: 11px; }
        .calc-label { flex: 1.5; padding: 6px; text-align: right; border-right: 1px solid #000; font-weight: bold; }
        .calc-val { flex: 1; padding: 6px; text-align: right; }

        .qr-section { text-align: center; padding: 20px 10px; flex-grow: 1; }
        .qr-img { width: 130px; height: 130px; margin-top: 5px; }
    </style>
</head>
<body>
    <div class="main-border">
        <div class="company-header">
            <div class="company-info">
                <b style="font-size: 16px;">ELECTROSOURCE PRIVATE LIMITED</b><br>
                Nashik : 422009, Maharashtra, India<br>
                GSTIN: 27AAFCE7605R1Z1
            </div>
            <div class="company-logo-area">
                <img src="{{logoBase64}}" style="max-height: 60px; width: auto; margin-bottom: 10px;" alt="Company Logo">
                <div style="font-size: 18px; font-weight: bold; color: #333;">Proforma Invoice</div>
            </div>
        </div>

        <div class="info-grid">
            <div class="info-col"><b>#PI NO:</b> {{billNo}}<br><b>Estimate Date:</b> {{date}}</div>
            <div class="info-col"><b>Place of Supply:</b> {{placeSupply}}<br><b>Payment Terms:</b> 100% Advance</div>
        </div>

        <div class="address-header">
            <div class="address-title">Bill To</div>
            <div class="address-title">Ship To</div>
        </div>
        <div class="address-content">
            <div class="address-box">{{{billTo}}}</div>
            <div class="address-box">{{{shipTo}}}</div>
        </div>

        <table>
            <thead>
                <tr>
                    <th style="width: 50%;">Item & Description</th>
                    <th style="width: 15%;">HSN/SAC</th>
                    <th style="width: 10%;">Qty</th>
                    <th style="width: 10%;">Rate</th>
                    <th style="width: 15%;">Amount</th>
                </tr>
            </thead>
            <tbody>
                <tr class="item-row">
                    <td><b>{{itemName}}</b></td>
                    <td>{{hsn}}</td>
                    <td>{{qty}}</td>
                    <td>{{rate}}</td>
                    <td>{{amount}}</td>
                </tr>
            </tbody>
        </table>

        <div class="footer-grid">
            <div class="footer-left">
                <p><b>Total In Words:</b><br>{{totalWords}}</p>
                <p style="margin-top: 40px;"><b>Bank Details:</b><br>{{{bankDetails}}}</p>
            </div>
            <div class="footer-right">
                <div class="calc-row">
                    <div class="calc-label">Sub Total</div>
                    <div class="calc-val">{{amount}}</div>
                </div>
                <div class="calc-row">
                    <div class="calc-label">CGST (9%)</div>
                    <div class="calc-val">{{cgst}}</div>
                </div>
                <div class="calc-row">
                    <div class="calc-label">SGST (9%)</div>
                    <div class="calc-val">{{sgst}}</div>
                </div>
                <div class="calc-row" style="background: #f2f2f2; font-weight: bold;">
                    <div class="calc-label">Total</div>
                    <div class="calc-val">Rs {{total}}</div>
                </div>
                <div class="qr-section">
                    <b>Scan & Pay</b><br>
                    <small>TID: 62279532</small><br>
                    <img src="{{qrCodeImage}}" class="qr-img">
                </div>
            </div>
        </div>
    </div>
</body>
</html>
